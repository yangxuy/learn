### HTTPS

##### 非对称加密+对称加密

A 先生成一个对话密钥，然后把对话密钥发送给 B。但是这个对话密钥要经过 B 的公钥进行加密，B 收到后用自己的私钥进行解密。这样就解决了对称加密时公钥容易被截取的缺陷。

这里容易造成中间人攻击：因为对话要进行 B 的公钥进行加密，攻击者可以截取 B 的公钥，用自己的公钥进行加密，获取到消息后在使用自己的秘钥进行解密

##### 数字证书

数字证书包括 公钥和数字签名 公钥通过 hash 算法可以得到数据摘要，数据摘要使用 CA 的私钥加密得到数字签名

##### HTTPS 5 次握手

1. 客户端向服务器发送一个支持的 TSL/SSL 协议版本，以及客户端支持的加密算法，同时生成第一个随机数
2. 服务器确认双方的加密方式，发送一个生成随机数，以及协议证书
3. 客户端确认证书是否可用，有效取出证书里面的公钥，生成一个随机数，使用公钥进行加密，发送个服务器
4. 服务器用私钥解密，获取发来的随机数
5. 客户端和服务器端使用预定好的加密方法，使用前面三个随机数生成对话秘钥，使用这个对话秘钥（session key）进行接下来的对话

##### Session 终断恢复

1. session id 每一次通话都有一个 session id 如果 Session 中断可以通过 session id 来判断
2. session ticket 是加密的，只有服务器才能解密，其中包括本次对话的主要信息，比如对话密钥和加密方法
